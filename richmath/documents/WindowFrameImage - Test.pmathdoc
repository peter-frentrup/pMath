/* pMath Document */

Document({
  SectionGroup({Section("Using $WindowFrameImage", "Title"), 
    Section(
     "You need to turn on \[HighSixDoubleQuote]Aero \
     Glass\[HighNineDoubleQuote] to see the frame image.", "Text"), 
    SectionGroup({
      Section(
       BoxData({"Button", "(", {StringBox("\"Open Window with Frame Image\""), 
          ",", {
           "\n", {"With", "(", {
             {"{", {"imgFile", "\[Assign]", {"FE`FileOpenDialog", "(", {
                 {"If", "(", {{"IsString", "(", "lastChosenImage", ")"}, ",", 
                   "lastChosenImage", ",", StringBox("\"\"")}, ")"}, ",", {
                  "{", {StringBox("\"PNG Images\""), "->", 
                   StringBox("\"*.png\"")}, "}"}}, ")"}}, "}"}, ",", {
              "\n", {{"If", "(", {{"IsString", "(", "imgFile", ")"}, ",", {
                  "\n", {{"lastChosenImage", "\[Assign]", "imgFile"}, ";", {
                    "\n", {"Block", "(", {{"{", "FE`$WindowFrameImage", "}"}, 
                      ",", {{"FE`$WindowFrameImage", "\[Assign]", "imgFile"}, 
                       ";", {"CreateDocument", "@@", {
                         "DocumentGet", "(", {"EvaluationDocument", "(", ")"}, 
                         ")"}}}}, ")"}}}}}, ")"}, ";"}}}, ")"}}}, ")"}), 
       "Input"), 
      Section(BoxData(ButtonBox(StringBox("\"Open Window with Frame Image\""), 
         ButtonFunction -> (
           With({
             Global`imgFile:= FE`FileOpenDialog(
               If(IsString(Global`lastChosenImage), Global`lastChosenImage, 
                ""), {"PNG Images" -> "*.png"})}, 
            If(IsString(Global`imgFile), 
              Global`lastChosenImage:= Global`imgFile; 
               Block({FE`$WindowFrameImage}, 
                FE`$WindowFrameImage:= Global`imgFile; 
                 Apply(DocumentGet(EvaluationDocument()), 
                  CreateDocument)));) &))), "Output", 
       SectionGenerated -> True)}, 2), 
    SectionGroup({
      Section(
       BoxData({"Grid", "(", {
          "{", {{"{", {StringBox("\"last chosen image:\""), "++", {
              "StringExpression", "@@", {"ConstantArray", "(", {
                StringBox("\"\\[U+2003]\""), ",", "20"}, ")"}}}, "}"}, ",", {
            "\n", {"{", {"InputField", "(", {
               {"Dynamic", "(", "lastChosenImage", ")"}, ",", "String"}, ")"}, 
             "}"}}}, "}"}, ")"}), "Input"), 
      Section(
       BoxData(
        TagBox(
         GridBox({
           {StringBox(
             "\"last chosen \
             image:\[U+2003]\[U+2003]\[U+2003]\[U+2003]\[U+2003]\[U+2003]\
             \[U+2003]\[U+2003]\[U+2003]\[U+2003]\[U+2003]\[U+2003]\[U+2003]\
             \[U+2003]\[U+2003]\[U+2003]\[U+2003]\[U+2003]\[U+2003]\[U+2003]\"\
             ")}, {InputFieldBox(Dynamic(Global`lastChosenImage), String)}}), 
         "Grid")), "Output", SectionGenerated -> True)}, 2), 
    SectionGroup({
      Section(BoxData({"Button", "(", {StringBox("\"+\""), ",", {
           "\n", {
            {"With", "(", {
              {"{", {"old", "\[Assign]", {StringBox("\"TopGlass\""), ".", 
                 "Replace", "(", {"DockedSections", ".", "Replace", "(", {
                   "Options", "(", {{"EvaluationDocument", "(", ")"}, ",", 
                    "DockedSections"}, ")"}, ")"}, ")"}}, "}"}, ",", {
               "\n", {"SetOptions", "(", {{"EvaluationDocument", "(", ")"}, 
                 ",", {"DockedSections", "\[Rule]", {
                   "{", {StringBox("\"TopGlass\""), "\[Rule]", {
                     "Flatten", "@", {
                      "{", {"old", ",", {"Section", "(", {
                         StringBox("\"\""), ",", StringBox("\"Docked\"")}, 
                        ")"}}, "}"}}}, "}"}}}, ")"}}}, ")"}, "\n"}}}, ")"}), 
       "Input"), 
      Section(BoxData(ButtonBox(StringBox("\"+\""), 
         ButtonFunction -> (
           With({
             Global`old:= Replace("TopGlass", 
               Replace(DockedSections, Options(EvaluationDocument(), 
                 DockedSections)))}, SetOptions(EvaluationDocument(), 
             DockedSections -> {
               "TopGlass" -> 
                Flatten({Global`old, Section("", "Docked")})})) &))), 
       "Output", SectionGenerated -> True)}, 2), 
    SectionGroup({
      Section(BoxData({"Button", "(", {StringBox("\"-\""), ",", {
           "\n", {
            {"With", "(", {
              {"{", {"old", "\[Assign]", {
                 "Flatten", "@", {"{", {StringBox("\"TopGlass\""), ".", 
                   "Replace", "(", {"DockedSections", ".", "Replace", "(", {
                     "Options", "(", {{"EvaluationDocument", "(", ")"}, ",", 
                      "DockedSections"}, ")"}, ")"}, ")"}, "}"}}}, "}"}, ",", {
               "\n", {{"If", "(", {{{"Length", "(", "old", ")"}, ">", "0"}, 
                  ",", {"SetOptions", "(", {{"EvaluationDocument", "(", ")"}, 
                    ",", {"DockedSections", "\[Rule]", {
                      "{", {StringBox("\"TopGlass\""), "\[Rule]", {
                        "Most", "@", "old"}}, "}"}}}, ")"}}, ")"}, "\n"}}}, 
             ")"}, "\n"}}}, ")"}), "Input"), 
      Section(BoxData(ButtonBox(StringBox("\"-\""), 
         ButtonFunction -> (
           With({
             Global`old:= 
              Flatten({
                Replace("TopGlass", Replace(DockedSections, 
                  Options(EvaluationDocument(), DockedSections)))})}, 
            If(Length(Global`old) > 0, SetOptions(EvaluationDocument(), 
              DockedSections -> {"TopGlass" -> Most(Global`old)}))) &))), 
       "Output", SectionGenerated -> True)}, 2)}, All)}, 
 Background -> GrayLevel(1), DockedSections :> {
   "TopGlass" -> {Section("", "Docked")}}, Editable -> True, 
 Selectable -> True, ShowSectionBracket -> False, 
 StyleDefinitions -> "Default.pmathdoc", Visible -> True, 
 WindowFrame -> "Dialog", WindowTitle -> "Using $WindowFrameImage")